<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>PFD Horizon</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background: black;
    }

    canvas {
      display: block;
      margin: auto;
      background: black;
    }
  </style>
</head>
<body>
<canvas id="pfd" width="500" height="500"></canvas>

<script>
  const canvas = document.getElementById("pfd");
  const ctx = canvas.getContext("2d");

  let roll = 0;   // degrés
  let pitch = 0;  // pixels

  let isDragging = false;
  let lastX = 0;
  let lastY = 0;

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();

    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;

    ctx.translate(centerX, centerY);
    ctx.rotate(-roll * Math.PI / 180);
    ctx.translate(0, pitch);

    // Répéter ciel et sol verticalement
    const bandHeight = 200;

    for (let y = -2000; y < 2000; y += bandHeight * 2) {
      // ciel
      ctx.fillStyle = "#0099ff";
      ctx.fillRect(-1000, y, 2000, bandHeight);
      // sol
      ctx.fillStyle = "#996633";
      ctx.fillRect(-1000, y + bandHeight, 2000, bandHeight);
    }

    // Ligne de l'horizon
    ctx.strokeStyle = "white";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(-canvas.width, 0);
    ctx.lineTo(canvas.width, 0);
    ctx.stroke();

    ctx.restore();

    // Réticule fixe au centre
    ctx.strokeStyle = "white";
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(centerX - 15, centerY);
    ctx.lineTo(centerX + 15, centerY);
    ctx.stroke();
  }

  // Contrôle via drag (swipe)
  canvas.addEventListener("pointerdown", e => {
    isDragging = true;
    lastX = e.clientX;
    lastY = e.clientY;
  });

  canvas.addEventListener("pointermove", e => {
    if (!isDragging) return;
    const dx = e.clientX - lastX;
    const dy = e.clientY - lastY;

    roll += dx * 0.3;  // rotation gauche/droite
    pitch += dy;       // translation haut/bas

    lastX = e.clientX;
    lastY = e.clientY;

    draw();
  });

  canvas.addEventListener("pointerup", () => {
    isDragging = false;
  });

  draw(); // initial
</script>
</body>
</html>
